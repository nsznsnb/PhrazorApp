@inherits LayoutComponentBase
@inject LoadingService LoadingService

<MudThemeProvider Theme="AppTheme.MyCustomTheme" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />
<MudLayout>
    <MudAppBar Elevation="1">
        <MudStaticNavDrawerToggle DrawerId="nav-drawer" Icon="@Icons.Material.TwoTone.Menu"  Edge="Edge.Start" />
        <MudLink Href="/" Class="ml-3" Style="text-decoration: none; color: inherit;">
            <AppLogo />
        </MudLink>
        <MudSpacer />
        <UserMenu />
    </MudAppBar>
    <MudDrawer id="nav-drawer" @bind-Open="_drawerOpen" ClipMode="DrawerClipMode.Always" Elevation="2" Class="full-height-drawer" >
        <NavMenu />
    </MudDrawer>
    <MudMainContent Class="px-4 pt-2" Style="margin-top: var(--mud-appbar-height);">
        <MudContainer>
            <MudBreakpointProvider OnBreakpointChanged="OnBpChanged" />
            <CascadingValue Value="CurrentBreakpoint">
                @Body
            </CascadingValue>
        </MudContainer>
        <MudScrollToTop>
            <MudFab Color="Color.Primary" StartIcon="@Icons.Material.TwoTone.KeyboardArrowUp" />
        </MudScrollToTop>
    </MudMainContent>

</MudLayout>
<ProgressingOverlay />


<div id="blazor-error-ui" data-nosnippet>
    未処理例外が発生しました。アプリケーションをリロードしてください。
    <a href="." class="reload">Reload</a>
    <span class="dismiss">🗙</span>
</div>


@code {
    private bool _drawerOpen = true;

    // 初期値はデスクトップ想定（初回レンダー後に実値へ更新されます）
    private Breakpoint CurrentBreakpoint = Breakpoint.Xl;

    private void OnBpChanged(Breakpoint bp)
    {
        CurrentBreakpoint = bp;
        StateHasChanged();
    }
}


