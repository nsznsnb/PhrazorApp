@page "/categories"
@using PhrazorApp.ViewModel
@inject NavigationManager NavigationManager
@inject ICategoryService CategoryService

<MudContainer>
    <MudStack Spacing="2">
        <MudStack Row Spacing="0">
            <MudIcon Icon="@Icons.Custom.Uncategorized.ChessQueen" Color="Color.Dark" Title="Favorite" Style="transform: translateY(2px)" />
            <h2>フレーズカテゴリ一覧</h2>
        </MudStack>
        <MudCard>
            <MudCardContent Class="py-2">
                <MudStack Row="true" Spacing="1">
                    <MudButton Variant="Variant.Filled" Size="Size.Small" Color="Color.Tertiary" StartIcon="@Icons.Material.Filled.Add" OnClick="@(() => NavigationManager.NavigateTo("/categories/create"))">新規追加</MudButton>
                </MudStack>
            </MudCardContent>
        </MudCard>
        <MudCard>
            <MudCardHeader>
                <CardHeaderContent>
                    <MudStack Row="true" Class="align-center">
                        <MudIcon Icon="@Icons.Material.Filled.ListAlt" Title="ListAlt" />
                        <h3>
                            フレーズカテゴリ一覧
                        </h3>
                    </MudStack>

                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudTable Items="@Elements" Hover="true" Height="500px" FixedHeader="true" Dense="true">
                    <HeaderContent>
                        <MudTh>カテゴリ</MudTh>
                        <MudTh style="min-width: 200px;">操作</MudTh>
                    </HeaderContent>
                    <RowTemplate>
                        <MudTd>
                            <MudStack Spacing="1">
                                <MudText Typo="Typo.subtitle1" Style="font-weight: 600;">@context.Name</MudText>
                                <MudTd >
                                    <MudStack Row Wrap="Wrap.Wrap" Spacing="0">
                                        @foreach (var sub in context.SubCategories)
                                        {
                                            <MudChip Color="Color.Default"
                                                     T="string"
                                                     Variant="Variant.Text"
                                                     Size="Size.Small">
                                                @sub.Name
                                            </MudChip>
                                        }
                                    </MudStack>
                                </MudTd>

                            </MudStack>

                        </MudTd>
                        <MudTd Align="Right" style="min-width: 200px;">
                            <MudStack Row="true">
                                <MudButton Variant="Variant.Outlined" Size="Size.Small" Color="Color.Secondary" StartIcon="@Icons.Material.Filled.Edit" OnClick="@(() => NavigationManager.NavigateTo($"/categories/edit/{context.Id}"))">@ComDefine.LABEL_BUTTON_EDIT</MudButton>
                                <MudButton Variant="Variant.Outlined" Size="Size.Small" Color="Color.Error" StartIcon="@Icons.Material.Filled.Delete">@ComDefine.LABEL_BUTTON_DELETE</MudButton>
                            </MudStack>
                        </MudTd>
                    </RowTemplate>
                </MudTable>
            </MudCardContent>

        </MudCard>



    </MudStack>
</MudContainer>



@code {
    [Inject] ISnackbar Snackbar { get; set; }



    private LargeCategoryModel model = new LargeCategoryModel();

    private List<LargeCategoryModel> Elements = new ();


    // private List<LargeCategoryModel> Elements = new List<LargeCategoryModel>
    // {
    //     new LargeCategoryModel { Id = new Guid(), Name = "ジャンル1", SubCategories = new List<SmallCategoryModel>() {
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル1" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },
    //         new SmallCategoryModel { Id = new Guid(), Name = "サブジャンル2" },

    //     } },
    //     new LargeCategoryModel { Id = new Guid(), Name = "ジャンル2" },
    //     new LargeCategoryModel { Id = new Guid(), Name = "ジャンル3" }
    // };

    protected override async Task OnInitializedAsync()
    {
        Elements = await CategoryService.GetCategoryViewModelListAsync();
    }



}
